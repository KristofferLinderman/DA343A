package p2;

import java.io.ObjectInputStream;
import java.net.Socket;
import javax.swing.Icon;

import javafx.beans.Observable;

public class IconClient implements Observable{
	private Buffer<Icon> iconBuffer;

	public IconClient(String ipAddress, int serverPort) {
		new Connection(ipAddress, serverPort);
	}
	
	public Buffer<Icon> getBuffer(){
		return iconBuffer;
	}

	private class Connection extends Thread {
		private String ipAddress;
		private int serverPort;

		public Connection(String ipAddress, int serverPort) {
			this.ipAddress = ipAddress;
			this.serverPort = serverPort;
		}

		public void run() {
			long time = System.currentTimeMillis();
			try (Socket socket = new Socket(ipAddress, serverPort);
					ObjectInputStream input = new ObjectInputStream(socket.getInputStream())) {

				iconBuffer = (Buffer<Icon>) input.readObject();
				
				time = System.currentTimeMillis() - time;
				System.out.println(time);
			} catch (Exception e) {
			}
		}
	}

}
